<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="eventMapper">


	<!-- 이벤트 쿠폰 insert -->
	<insert id="insertEventCoupon" parameterType="java.util.Map">
		INSERT INTO COUPON (
			COUPON_ID, COUPON_NAME, DISCOUNT_RATE, DISCOUNT_AMOUNT, 
			ISSUANCE_DATE, EXPIRATION_DATE, MINIMUM_AMOUNT, MEMBER_ID
		) 
		VALUES(
			LPAD(TO_CHAR(seq_coupon_id.NEXTVAL), 8, '0'), '룰렛 쿠폰', #{discountRate}, NULL, SYSDATE, SYSDATE + INTERVAL '1' MONTH, 15000, #{memberId}
		)
	</insert>
	
	
	<select id="rouletteEventCheck" parameterType="_int" resultType="_int">
		SELECT *
		FROM COUPON
		WHERE MEMBER_ID = #{memberId}
		AND TO_CHAR(ISSUANCE_DATE, 'DD') = TO_CHAR(SYSDATE, 'DD')
	</select>
 	


</mapper>


